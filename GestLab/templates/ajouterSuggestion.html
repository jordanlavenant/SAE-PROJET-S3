{% extends 'base.html' %}
{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='./css/ajouterSuggestion.css') }}">
{% endblock %}
{% block content %}
<a id="btn-back" href="{{ url_for('demander') }}">retour</a>
<div class="ajouterSuggestion-container">
    <form class="form-ajoutSuggestion" role="form" method="POST" action="{{ url_for('ajouter_suggestion') }}">
        {{ AjouterSuggestionForm.hidden_tag() }}

        <div class="left-side-info">

            <div class="user-box domaine-container">
                <label for="domaine">Domaine : </label>
                <div>{{ AjouterSuggestionForm.domaine(size=auto, class_="comboBox dom-select") }}</div>
            </div>

            <div class="user-box categorie-container">
                <label for="categorie">Catégorie : </label>
                <div>{{ AjouterSuggestionForm.categorie(size=auto, class_="comboBox cat-select") }}</div>
            </div>

            <div class="pair-info">
                <div class="user-box name-container">
                    <label for="nom">Nom : </label>
                    <div>{{ AjouterSuggestionForm.nom(size=40, class_="form-control element", placeholder="Nom", value=nom) }}</div>
                </div>
            </div>
        
            <div class="pair-info">
                <div class="user-box reference-container">
                    <label for="reference">Référence : </label>
                    <div>{{ AjouterSuggestionForm.reference(size=15, class_="form-control element", placeholder="Rèf.", value=reference) }}</div>
                </div>
                <div class="user-box seuil-alerte-container">
                    <label for="seuilalerte">Seuil de quantité : </label>
                    <div>{{ AjouterSuggestionForm.seuilalerte(size=15 , class_="form-control element", placeholder="Quantité minimale", value=seuilalerte) }}</div>
                </div>
            </div>
            <div class="fds">
                <div>
                    <input type="checkbox" id="comburant" name="comburant" value="1"/>
                    <label for="comburant">Comburant</label><br/>
                    <input type="checkbox" id="inflammable" name="inflammable" value="2"/>
                    <label for="inflammable">Danger incendie</label><br/>
                    <input type="checkbox" id="explosif" name="explosif" value="3"/>
                    <label for="explosif">Explosif</label><br/>
                    <input type="checkbox" id="CMR" name="CMR" value="4"/>
                    <label for="CMR">Effets graves sur la santé</label><br/>
                    <input type="checkbox" id="santé" name="santé" value="5"/>
                    <label for="santé">Altération de la santé humaine</label><br/>
                </div>
                <div>
                    <input type="checkbox" id="gaz" name="gaz" value="6"/>
                    <label for="gaz">Gaz sous pression</label><br/>
                    <input type="checkbox" id="corrosif" name="corrosif" value="7"/>
                    <label for="corrosif">Corrosion</label><br/>
                    <input type="checkbox" id="environnement" name="environnement" value="8"/>
                    <label for="environnement">Toxicité aquatique</label><br/>
                    <input type="checkbox" id="toxique" name="toxique" value="9"/>
                    <label for="toxique">Toxicité aiguë</label><br/>
                </div>
            </div>
        </div>

        <div class="right-side-info">

            <div class="user-box description-container">
                <div>{{ AjouterSuggestionForm.caracteristiques(size=20, class_="form-control text-area", placeholder="Caractéristiques", value=caracteristiques,cols="30", rows="10") }}</div> 
            </div>
    
            <div class="user-box infossup-container">
                <div>{{ AjouterSuggestionForm.infossup(size=20, class_="form-control text-area", placeholder="Informations complémentaires, mesures de sécurité...", value=infossup,cols="30", rows="10") }}</div>
            </div>
    
            <div class="valid-container">
                <input type="submit" value="AJOUTER MATERIEL" class="element submit">
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const domaineSelect = document.getElementById("domaine");
        const categorieSelect = document.getElementById("categorie");

        domaineSelect.addEventListener("change", function() {
            const selectedDomaine = domaineSelect.value;
            fetch(`/get_categorie_choices?domaine_id=${selectedDomaine}`)
                .then(response => response.json())
                .then(data => {
                    categorieSelect.innerHTML = '';
                    for (const [key, value] of Object.entries(data)) {
                        const option = document.createElement("option");
                        option.value = key;
                        option.text = value;
                        categorieSelect.appendChild(option);
                    }
                })
                .catch(error => console.error(error));
        });
    });
</script>
{% endblock %}